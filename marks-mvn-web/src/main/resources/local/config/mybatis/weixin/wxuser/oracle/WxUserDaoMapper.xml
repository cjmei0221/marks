<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.marks.module.weixin.wfhao.dao.WxUserDao">

	<insert id="save" parameterType="com.marks.module.weixin.wfhao.pojo.WxUser">
		<selectKey keyProperty="fanId" resultType="String" order="BEFORE">SELECT
			'F'||SEQ_WX_USER.nextval FROM dual
		</selectKey>
		INSERT INTO TB_WX_USER wxuser (
		wxuser.OPENID,
		wxuser.NICKNAME,
		wxuser.GROUPID,
		wxuser.COUNTRY,
		wxuser.PROVINCE,
		wxuser.CITY,
		wxuser.SEX,
		wxuser.IMAGEURL,
		wxuser.LANGUAGE,
		wxuser.ISSUBSCRIBE,
		wxuser.SUBSCRIBETIME,
		wxuser.UPDATETIME,
		wxuser.ACCOUNTID,
		wxuser.CREATETIME,
		wxuser.USEFLAG,
		wxuser.QRNO,
		wxuser.REMARK,
		wxuser.FANID
		)
		VALUES(
		#{openid:VARCHAR},
		#{nickname:VARCHAR},
		#{groupid:NUMERIC},
		#{country:VARCHAR},
		#{province:VARCHAR},
		#{city:VARCHAR},
		#{sex:NUMERIC},
		#{imageUrl:VARCHAR},
		#{language:VARCHAR},
		#{issubscribe:NUMERIC},
		#{subscribetime:TIMESTAMP},
		sysdate,
		#{accountid:VARCHAR},
		sysdate,
		#{useflag:NUMERIC},
		#{qrNo:VARCHAR},
		#{remark:VARCHAR},
		#{fanId:VARCHAR}
		)
	</insert>

	<update id="update" parameterType="com.marks.module.weixin.wfhao.pojo.WxUser">
		UPDATE TB_WX_USER wxuser
		SET
		wxuser.NICKNAME = #{nickname:VARCHAR},
		wxuser.GROUPID =
		#{groupid:NUMERIC},
		wxuser.COUNTRY = #{country:VARCHAR},
		wxuser.PROVINCE = #{province:VARCHAR},
		wxuser.CITY = #{city:VARCHAR},
		wxuser.SEX = #{sex:NUMERIC},
		wxuser.IMAGEURL = #{imageUrl:VARCHAR},
		wxuser.LANGUAGE = #{language:VARCHAR},
		wxuser.ISSUBSCRIBE =
		#{issubscribe:NUMERIC},
		wxuser.SUBSCRIBETIME =
		#{subscribetime:TIMESTAMP},
		wxuser.UPDATETIME =sysdate,
		wxuser.REMARK =
		#{remark:VARCHAR}
		WHERE
		wxuser.OPENID = #{openid} and wxuser.ACCOUNTID =
		#{accountid:VARCHAR}
	</update>
	<select id="getFanId" resultType="String">
		SELECT 'F'||SEQ_WX_USER.nextval FROM dual
	</select>
	<update id="updateFanIdForWxUser">
		UPDATE TB_WX_USER
		SET
		FANID = #{fanId:VARCHAR}
		WHERE
		OPENID =
		#{openid:VARCHAR} and ACCOUNTID = #{accountid:VARCHAR}
	</update>
</mapper>