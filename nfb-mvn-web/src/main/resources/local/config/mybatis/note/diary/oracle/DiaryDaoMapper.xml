<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.cjmei.module.note.diary.dao.DiaryDao">

	<select id="findById" resultType="com.cjmei.module.note.diary.pojo.Diary">
		SELECT * FROM TB_NOTE_DIARY
		diary
		where diary.ID = #{id}
	</select>

	<insert id="save" parameterType="com.cjmei.module.note.diary.pojo.Diary">
		INSERT INTO TB_NOTE_DIARY diary (
		diary.ID,
		diary.UPDATETIME,
		diary.CONTENT,
		diary.CREATOR,
		diary.TITLE,
		diary.CREATETIME
		)
		VALUES(
		#{id:VARCHAR},
		sysdate,
		#{content:VARCHAR},
		#{creator:VARCHAR},
		#{title:VARCHAR},
		sysdate
		)
	</insert>

	<update id="update" parameterType="com.cjmei.module.note.diary.pojo.Diary">
		UPDATE TB_NOTE_DIARY diary
		SET
		diary.UPDATETIME = sysdate,
		diary.CONTENT = #{content:VARCHAR},
		diary.TITLE = #{title:VARCHAR}
		WHERE
		diary.ID = #{id}
	</update>

	<delete id="delete" parameterType="String">
		DELETE FROM TB_NOTE_DIARY
		diary WHERE diary.ID=#{id}
	</delete>

	<select id="findAll" resultType="com.cjmei.module.note.diary.pojo.Diary">
		SELECT * FROM TB_NOTE_DIARY
	</select>

	<delete id="deleteBatch" parameterType="java.util.List">
		DELETE FROM TB_NOTE_DIARY WHERE ID in
		<foreach collection="list" item="ids" index="index" open="("
			separator="," close=")">
			#{ids}
		</foreach>
	</delete>

	<select id="list" resultType="com.cjmei.module.note.diary.pojo.Diary"
		parameterType="java.util.Map">
		SELECT diary.*
		FROM TB_NOTE_DIARY diary
		WHERE 1=1
		<if test="keyword!=null and keyword!=''">
			and (
			diary.CONTENT LIKE
			CONCAT(CONCAT('%',#{keyword:VARCHAR}),'%')
			or
			to_char(diary.CREATETIME,'yyyy-mm-dd') LIKE
			CONCAT(CONCAT('%',#{keyword:VARCHAR}),'%')
			or
			diary.TITLE LIKE
			CONCAT(CONCAT('%',#{keyword:VARCHAR}),'%')
			)
		</if>
		<if test="userid!=null and userid!=''">
			and diary.CREATOR =#{userid:VARCHAR}
		</if>
		order by diary.CREATETIME desc
	</select>



</mapper>